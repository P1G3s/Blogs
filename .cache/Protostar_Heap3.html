<h1 id="protostar_heap3">Protostar_Heap3</h1>
<h3 id="chunk">Chunk</h3>
<p><img src="../images/Protostar_Heap3/Chunk.png" alt="Chunk"></p>
<h3 id="chunk-list-double-linked-list">Chunk List (double linked list)</h3>
<p><img src="../images/Protostar_Heap3/Chunk_List.png" alt="Chunk"></p>
<h3 id="freechunk38">Free(*(chunk3+8))</h3>
<p><img src="../images/Protostar_Heap3/Free.png" alt="Chunk"></p>
<p>Assuming that chunk2 is next to chunk3 (on its left), and chunk4 is next to chunk3 (on its right) the function free()</p>
<ul>
<li>checks if <strong>chunk2</strong> is in use (by the last bit of chunk3-&gt;size)</li>
<li>if not<ul>
<li>chunk2_ptr = chunk3_ptr - prev_size</li>
<li><strong>unlink(chunk2_ptr,bck,fwd)</strong> &lt;-- a macro  (after unlink, chunk2 is consolidated with chunk1)</li>
</ul>
</li>
<li>checks if <strong>chunk4</strong> is in use (by the last bit of chunk5-&gt;size)</li>
<li>if not<ul>
<li>chunk4_ptr = chunk3 + size</li>
<li><strong>unlink(chunk4_ptr,bck,fwd)</strong></li>
</ul>
</li>
</ul>
<p>If neither chunk2 nor chunk4 is free, then put chunk3 straight to the Chunk list by <strong>setting <em>chunk3_ptr-&gt;bk = list[0]</em> and <em>chunk3_ptr-&gt;fd = list[1]</em></strong></p>
<p>The exploit is unlink()</p>
